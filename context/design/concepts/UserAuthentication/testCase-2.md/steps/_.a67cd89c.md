---
timestamp: 'Wed Oct 15 2025 08:25:46 GMT-0400 (Eastern Daylight Time)'
parent: '[[../20251015_082546.932dccf8.md]]'
content_id: a67cd89c8238a908fb72e5532c67fe4459bd8e8019164b510c1f95669d190e8b
---

# Test implementation

While testing, use the `testDb` function, which returns a tuple of the database and client so that you can close it.

```typescript
import { testDb } from "@utils/database.ts";

Deno.test("...", async () => {
  const [db, client] = await testDb();

  // ... tests

  await client.close();
});
```

The database is already automatically dropped before every test file using the `Deno.test.beforeAll` hook: do not include any additional manipulation of the database for this purpose.

Use the Deno.test framework, splitting by appropriate test steps and describing each behavior. Import helpers from:

```typescript
import { assertEquals } from "jsr:@std/assert"; // or any other utility from the library
```

Create "UserAuthentication - Case 2 (Verify Password Changing)" with steps:

1. Create first admin user Jacky.
   * Able to authenticate
2. Create second user Henry
   * Able to authenticate
3. Verify Henry cannot change Jacky's password (as he isn't admin)
4. Verify Jacky is able to change Jacky's password.
   * Does not authenticate with old password
   * Can authenticate with new password
5. Verify Jacky is able to change Henry's password.
   * Does not authenticate with old password
   * Can authenticate with new password
